# Multi-Cam Sprite Renderer - Godot Import Plugin

This Godot plugin automatically imports sprite sheets generated by the Multi-Cam Sprite Renderer Blender addon. It reads `metadata.json` files and creates Godot `SpriteFrames` resources with proper animations and materials for normal mapping.

## Features

- **Automatic Import**: Simply drag and drop `metadata.json` files into your Godot project
- **Animation Support**: Creates animations from sprite sheet data with proper frame timings
- **Normal Map Integration**: Automatically sets up materials with normal maps for 2D lighting
- **2D and 3D Modes**: Supports both traditional 2D sprites and 3D billboard sprites
- **Multiple Camera Angles**: Handles sprite sheets generated from multiple camera positions
- **Scene Generation**: Optionally creates ready-to-use scenes with configured nodes
- **Batch Import**: Import all metadata files in your project with one click
- **Editor Integration**: Provides a convenient dock panel for manual operations

## Installation

### Method 1: Manual Installation
1. Copy the `godot_plugin` folder to your Godot project's `addons` directory as `addons/mcsr_importer/`
2. Enable the plugin in Project Settings > Plugins
3. The plugin will automatically handle `metadata.json` files when they are imported

### Method 2: Using the Installation Script
1. Run the provided installation script:
   ```bash
   ./install.sh /path/to/your/godot/project
   ```
2. Enable the plugin in Project Settings > Plugins

## Usage

### Automatic Import

1. Export sprite sheets from the Multi-Cam Sprite Renderer Blender addon
2. Copy the generated files (including `metadata.json`) to your Godot project
3. The plugin will automatically detect and import the `metadata.json` file
4. A `SpriteFrames` resource will be created with all animations and frames
5. If normal maps are present, a material will also be created

### Manual Import via Editor Dock

The plugin adds a dock panel to the Godot editor with additional options:

- **Select metadata.json**: Manually choose a metadata file to import
- **Import All in Project**: Batch import all metadata files found in the project
- **Options**: Configure import settings like material creation and animation looping

### Import Options

When importing, you can configure these options:

#### Import Mode
- **2D Mode (Default)**: Creates `CanvasItemMaterial` for 2D sprites
- **3D Billboard Mode**: Creates `StandardMaterial3D` for 3D billboard sprites

#### Camera Angle
- **Range**: 0-7 (matches camera positions from Blender addon)
- **Default**: 0 (uses camera_0 folder)
- Choose which camera angle to use for the imported sprites

#### Additional Options
- **Create Normal Material**: Whether to generate materials with normal maps
- **Loop Animations**: Whether animations should loop by default  
- **Create Scene**: Generate a sample scene with configured nodes

### Using the Generated Resources

#### For 2D Games:
```gdscript
# In your script
@export var sprite_frames: SpriteFrames
@export var sprite_material: CanvasItemMaterial

func _ready():
    # Apply to AnimatedSprite2D
    var animated_sprite = $AnimatedSprite2D
    animated_sprite.sprite_frames = sprite_frames
    animated_sprite.material = sprite_material
    animated_sprite.play("idle")  # Replace with your animation name
```

#### For 3D Games:
```gdscript
# In your script  
@export var sprite_frames: SpriteFrames
@export var sprite_material: StandardMaterial3D

func _ready():
    # Apply to MeshInstance3D with QuadMesh
    var mesh_instance = $MeshInstance3D
    var quad_mesh = QuadMesh.new()
    mesh_instance.mesh = quad_mesh
    mesh_instance.material_override = sprite_material
```

## File Structure

The plugin expects the following file structure from the Blender addon:

```
project_folder/
├── metadata.json
└── action_name/
    ├── camera_0/
    │   ├── diffuse.png
    │   ├── normal.png
    │   └── ...
    ├── camera_1/
    │   ├── diffuse.png
    │   ├── normal.png
    │   └── ...
    └── ...
```

## Supported Metadata Format

The plugin reads `metadata.json` files with this structure:

```json
{
  "fps": 24,
  "frameDimensions": {
    "width": 1024,
    "height": 1024
  },
  "passes": ["diffuse", "normal"],
  "actions": [
    {
      "name": "idle",
      "sprites": [
        {
          "x": 0,
          "y": 0,
          "frames": 1
        },
        {
          "x": 1024,
          "y": 0,
          "frames": 2
        }
      ]
    }
  ]
}
```

## Advanced Features

### Multiple Camera Angles
The plugin supports sprite sheets generated from multiple camera positions. Use the `camera_angle` import option to select which camera angle to use (0-7).

### Material Types
- **2D Mode**: Creates `CanvasItemMaterial` with normal map support for 2D lighting
- **3D Mode**: Creates `StandardMaterial3D` with billboard settings for 3D environments

### Scene Generation
Enable "Create Scene" to automatically generate a sample scene with:
- **2D Mode**: `Node2D` root with `AnimatedSprite2D` child
- **3D Mode**: `Node3D` root with `MeshInstance3D` child using a quad mesh

## Troubleshooting

### Import Not Working
- Ensure the file is named `metadata.json`
- Check that the JSON structure matches the expected format
- Verify that sprite sheet images exist in the expected locations
- Use the editor dock to manually import and see detailed error messages

### Missing Textures
- The plugin looks for textures in multiple locations based on camera angle:
  - `action_name/camera_N/pass_name.png` (where N is the camera angle)
  - `action_name/camera_0/pass_name.png` (fallback)
  - `action_name/pass_name.png`  
  - `pass_name.png`
- Ensure your sprite sheet files follow one of these patterns

### Normal Maps Not Applied
- Check that "normal" is listed in the `passes` array in metadata.json
- Ensure normal map files exist alongside diffuse textures
- Verify that "Create Normal Material" is enabled in import options

### Plugin Not Appearing
- Ensure the plugin files are in `addons/mcsr_importer/` directory
- Check that the plugin is enabled in Project Settings > Plugins
- Restart Godot after installation

## Development and Extension

The plugin is designed to be extensible. Key components:

- `mcsr_importer.gd`: Main import plugin implementation
- `mcsr_material_helper.gd`: Material and SpriteFrames creation logic
- `mcsr_dock.gd`: Editor UI dock for manual operations
- `plugin.gd`: Plugin registration and lifecycle management

## License

This plugin is part of the Multi-Cam Sprite Renderer project and follows the same license terms.